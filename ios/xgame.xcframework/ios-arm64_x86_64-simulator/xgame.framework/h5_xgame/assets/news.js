import{j as e,M as g,a0 as L,r as o,g as H,u as M,T as r,Y as O,H as y,$ as F,R as V}from"./index.sdk-0.0.1.js";import{r as A,g as b}from"./news2.js";import{S as G}from"./modals.js";import{N as J}from"./normal-layout.js";import{N as P}from"./no-record.js";import{S as v}from"./Skeleton.js";import"./Modal.js";import"./main-layout.js";import"./popover.js";import"./lazy-load-component.js";import"./emotion-react.browser.esm.js";function C({checked:s,className:n="",onChange:l}){return e.jsx("span",{className:`w-6 h-6 inline-flex circle items-center justify-center bg-[var(--box-bg)] ${n}`,onClick:()=>l(!s),children:e.jsx(g,{color:s?"#ffffff":"#4f4f56",name:"ic_tick",className:"w-6 h-6"})})}const U=L({key:"news",default:{data:[],totalCount:0,page:1,rows:20}});function oe(){const[s,n]=o.useState([]),[l,i]=o.useState(!1),[a,d]=H(U),[f,h]=o.useState(!1),[S,x]=o.useState(!1),[q,u]=o.useState(!1),[p,w]=o.useState(!1),{i18n:{language:k}}=M(),_=t=>{if(s.includes(t.id)){n(s.filter(c=>c!=t.id));return}n([...s,t.id])},T=()=>{if(s.length==a.data.length){n([]);return}n(a.data.map(t=>t.id))},R=()=>{s.length!=0&&x(!0)},D=async()=>{try{u(!0),await Promise.all(s.map(t=>A(t))),await j()}catch{}finally{i(!1),n([]),x(!1),u(!1),y.showToast(r.successfully_deleted())}},j=async()=>{a.data.length==0&&h(!0);const t={page:1,rows:20},c=await b(t);d({...t,...c}),h(!1)},I=async t=>{const{scrollTop:c,scrollHeight:E,clientHeight:$}=t.target;if(c+$+200>E&&a.data.length<a.totalCount&&!p){w(!0);const N={page:a.page+1,rows:20};try{const m=await b(N);d({...a,page:N.page,totalCount:m.totalCount,data:[...a.data,...m.data]})}catch(m){console.error("Error fetching news:",m)}finally{w(!1)}}};return o.useEffect(()=>{j()},[k]),e.jsx(J,{title:r.notification(),className:"max-w-[800px] mx-auto ",rightEl:e.jsxs(e.Fragment,{children:[!l&&e.jsx(g,{color:"var(--arrow-color)",name:"ic_delete2",className:" w-4 h-5",onClick:()=>i(!0)})," ",l&&e.jsx("span",{onClick:()=>i(!1),className:"text-sm text-[var(--active)]",children:r.finish()})]}),children:e.jsxs(e.Fragment,{children:[f&&e.jsx(O,{className:"grow"}),!f&&a.data.length==0&&e.jsx(P,{className:"grow"}),e.jsxs("div",{className:" overflow-hidden overflow-y-auto hide-scrollbar h-full pb-3",onScroll:I,children:[e.jsxs("div",{className:"flex flex-col gap-2 w-full h-full p-3",children:[a.data.length>0&&a.data.map(t=>e.jsx(Y,{showDelete:l,selected:s.includes(t.id),onChange:()=>_(t),item:t},t.id)),p&&e.jsxs("div",{className:"p-4 mb-3 relative rounded-md bg-[var(--box-bg)] h-[92px]",children:[e.jsx("div",{className:"flex justify-between items-center w-full mb-2 text-lg font-bold",children:e.jsx(v,{animation:"wave",width:"100%"})}),e.jsx("div",{className:"flex justify-between items-center w-full",children:e.jsx(v,{animation:"wave",width:"100%"})})]})]}),l&&e.jsxs("div",{className:"fixed bottom-0 w-full flex items-center justify-between bg-[var(--box-bg)] p-3 pb-5",children:[e.jsx(C,{checked:s.length==a.data.length,onChange:()=>T()}),e.jsx("span",{className:"grow px-2 text-[#7e7e81]",children:r.select_all()}),e.jsxs("button",{onClick:R,className:`flex items-center gap-3 rounded-full bg-[var(--separator2)] uppercase px-3 py-2 ${s.length>0?"text-[#ffffff]":"text-[#949496]"}`,children:[e.jsx(g,{color:s.length>0?"text-[#ffffff]":"text-[#6f6f73]",name:"ic_delete2",className:"w-4 h-5"}),r.delete()]})]}),e.jsx(G,{content:r.delete_noti(),onClose:()=>x(!1),onConfirm:D,open:S})]})]})})}function Y({showDelete:s,selected:n,item:l,onChange:i}){const a=()=>{const d=JSON.stringify(l),f=F(d);y.navigate(`${V.newsDetail}?key=${f}`)};return e.jsxs("div",{className:"flex items-center gap-3",children:[s&&e.jsx("div",{children:e.jsx(C,{checked:n,onChange:()=>i()})}),e.jsxs("div",{onClick:a,className:"p-3 rounded-md bg-[var(--box-bg)] grow",children:[e.jsx("h2",{className:"text-lg font-semibold text-[#e7e7e7] leading-5",children:l.messageTitle}),e.jsx("p",{className:"text-xs text-[#8b8b8f] py-1",children:l.messageContent}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx("span",{className:"text-xs text-[#4b4c51]",children:l.addTime}),e.jsx("span",{className:`w-2 h-2 circle ${l.readStatus==0?"bg-[var(--active)]":"bg-[#58585c]"} `})]})]})]})}export{oe as NewsView};
