import{b as E,h as L,r as c,T as n,j as e,a8 as d,af as b}from"./index.sdk-0.0.1.js";import{N as Y}from"./normal-layout.js";import{q as C}from"./agent2.js";import"./main-layout.js";import"./popover.js";import"./Modal.js";import"./lazy-load-component.js";function F(){const{userInfo:o}=E(L),[l,v]=c.useState(0),[i,w]=c.useState([]),[h,g]=c.useState([]),[f,j]=c.useState([]),[m,D]=c.useState(0),p=c.useRef(1),N=[n.today_2(),n.yesterday(),n.this_month()],u=c.useRef(!1),R=r=>{const s=h.filter(t=>t.userId==r).map(t=>({currency:t.currency,amount:t.rechMoney}));return d.convertToSystemCurrency(s)},S=r=>{const s=f.filter(t=>t.userId==r).map(t=>({currency:t.currency,amount:t.liveValidMoney}));return d.convertToSystemCurrency(s)},x=async(r=!1)=>{u.current=!0,r?p.current+=1:p.current=1;const s=new Date,t=new Date;l==1&&(t.setDate(t.getDate()-1),s.setDate(s.getDate()-1)),l==2&&t.setDate(1);const a=await C({account:"",beginDate:b(t).format("YYYY-MM-DD"),endDate:b(s).format("YYYY-MM-DD"),page:p.current,rows:20});console.log(a),D(a.totalCount),g(r?[...h,...a.otherData.rwReport]:a.otherData.rwReport),j(r?[...f,...a.otherData.betReport]:a.otherData.betReport),w(r?[...i,...a.data]:a.data),u.current=!1};c.useEffect(()=>{x()},[l]);const y=async()=>{const{scrollTop:r,scrollHeight:s,clientHeight:t}=document.documentElement||document.body;if(r+t+100>s&&i.length<m&&!u.current){u.current=!0;try{await x(!0)}catch(_){console.error("Error fetching news:",_)}finally{u.current=!1}}};return c.useEffect(()=>(window.addEventListener("scroll",y),()=>window.removeEventListener("scroll",y)),[l,m,i]),e.jsx(Y,{title:n.new_subordinates(),className:"max-w-[800px] mx-auto",hideRightEl:!0,children:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pl-3 py-3",children:e.jsx("div",{className:"flex gap-3 overflow-x-auto hide-scrollbar text-sm",children:N.map((r,s)=>e.jsx("span",{onClick:()=>v(s),className:`rounded-full bg-[var(--input-bg)] px-6 py-2 whitespace-nowrap leading-none ${l==s?"text-[var(--active)]":"text-[var(--text-content-color)]"}`,children:r},s))})}),e.jsxs("div",{className:"rounded-xl",style:{background:"linear-gradient(to bottom, var(--box-bg), transparent 40%)"},children:[e.jsxs("div",{className:"flex text-xs text-[#55545c] border-b border-b-[var(--box-separator)] py-2",children:[e.jsx("span",{className:"w-1/4 text-center",children:n.tiers()}),e.jsx("span",{className:"w-1/4 text-center",children:n.account()}),e.jsx("span",{className:"w-1/4 text-center",children:n.deposit_amount()}),e.jsx("span",{className:"w-1/4 text-center",children:n.bet_amount()})]}),i.map((r,s)=>{var t,a;return e.jsxs("div",{className:"flex text-sm text-[var(--text-content-color)] border-b border-b-[var(--box-separator)] py-3",children:[e.jsx("span",{className:"w-1/4 text-center",children:r.dlLevel-((o==null?void 0:o.dlLevel)??0)==0?n.general_agent():n.level_n({__n__:r.dlLevel-((o==null?void 0:o.dlLevel)??0)})}),e.jsx("span",{className:"w-1/4 text-center",children:r.account}),e.jsxs("span",{className:"w-1/4 text-center ",children:[R(r.userId)," ",e.jsx("span",{className:"text-xs",children:(t=d.defaultCurrency)==null?void 0:t.currency})]}),e.jsxs("span",{className:"w-1/4 text-center",children:[S(r.userId)," ",e.jsx("span",{className:"text-xs",children:(a=d.defaultCurrency)==null?void 0:a.currency})]})]},s)}),m>i.length&&e.jsx("div",{onClick:()=>x(!0),className:"text-center py-6 text-sm text-[#e1e2e230]",children:n.show_all()})]})]})})}export{F as NewSubordinates};
