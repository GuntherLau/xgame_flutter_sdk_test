import{r as l,R as w,dj as F,j as t,C as E,dk as R,H as v,T as j,l as x,G as b,bR as N,dl as B,dm as O,u as P,dn as U,t as T,v as q,dp as D,dq as $,x as H}from"./index-BRyeyo8a.js";function M({onDone:n}){const[e,d]=l.useState(!1),s=w(F),i=()=>{const a=document.getElementsByTagName("script")[0];if(document.getElementById("facebook-jssdk"))return;const o=document.createElement("script");o.id="facebook-jssdk",o.src="https://connect.facebook.net/en_US/sdk.js",a.parentNode.insertBefore(o,a),o.onload=()=>d(!0)};l.useEffect(()=>{i()},[]);const u=async a=>{var o,r;try{await R({token:a,provider:"facebook"}),v.showToast(j.login_successfully()),n()}catch(f){console.log("error:",f),x.emit(b.showError,((r=(o=f.response)==null?void 0:o.data)==null?void 0:r.message)??f.message)}},c=()=>{window.FB.login(function(a){var o;console.log(a),(o=a.authResponse)!=null&&o.accessToken&&u(a.authResponse.accessToken)})};return l.useEffect(()=>{s&&e&&window.FB.init({appId:s,xfbml:!0,version:"v9.0"})},[s,e]),t.jsx(E,{onClick:()=>c(),src:"/assets/dummy/facebook.png",alt:"",className:"h-7"})}function V(n={}){const{nonce:e,onScriptLoadSuccess:d,onScriptLoadError:s}=n,[i,u]=l.useState(!1),c=l.useRef(d);c.current=d;const a=l.useRef(s);return a.current=s,l.useEffect(()=>{const o=document.createElement("script");return o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.nonce=e,o.onload=()=>{var r;u(!0),(r=c.current)===null||r===void 0||r.call(c)},o.onerror=()=>{var r;u(!1),(r=a.current)===null||r===void 0||r.call(a)},document.body.appendChild(o),()=>{document.body.removeChild(o)}},[e]),i}const C=l.createContext(null);function X({clientId:n,nonce:e,onScriptLoadSuccess:d,onScriptLoadError:s,children:i}){const u=V({nonce:e,onScriptLoadSuccess:d,onScriptLoadError:s}),c=l.useMemo(()=>({clientId:n,scriptLoadedSuccessfully:u}),[n,u]);return N.createElement(C.Provider,{value:c},i)}function z(){const n=l.useContext(C);if(!n)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return n}function J({flow:n="implicit",scope:e="",onSuccess:d,onError:s,onNonOAuthError:i,overrideScope:u,state:c,...a}){const{clientId:o,scriptLoadedSuccessfully:r}=z(),f=l.useRef(),k=l.useRef(d);k.current=d;const L=l.useRef(s);L.current=s;const S=l.useRef(i);S.current=i,l.useEffect(()=>{var g,m;if(!r)return;const A=n==="implicit"?"initTokenClient":"initCodeClient",G=(m=(g=window==null?void 0:window.google)===null||g===void 0?void 0:g.accounts)===null||m===void 0?void 0:m.oauth2[A]({client_id:o,scope:u?e:`openid profile email ${e}`,callback:p=>{var h,_;if(p.error)return(h=L.current)===null||h===void 0?void 0:h.call(L,p);(_=k.current)===null||_===void 0||_.call(k,p)},error_callback:p=>{var h;(h=S.current)===null||h===void 0||h.call(S,p)},state:c,...a});f.current=G},[o,r,n,e,c]);const y=l.useCallback(g=>{var m;return(m=f.current)===null||m===void 0?void 0:m.requestAccessToken(g)},[]),I=l.useCallback(()=>{var g;return(g=f.current)===null||g===void 0?void 0:g.requestCode()},[]);return n==="implicit"?y:I}function K({onDone:n}){const e=w(B);return e?t.jsx(X,{clientId:e,children:t.jsx(Q,{onDone:n})}):t.jsx(t.Fragment,{})}function Q({onDone:n}){const d=J({onSuccess:async s=>{var i,u;try{await R({token:s.access_token,provider:"google"}),v.showToast(j.login_successfully()),n()}catch(c){console.log("error:",c),x.emit(b.showError,((u=(i=c.response)==null?void 0:i.data)==null?void 0:u.message)??c.message)}},onError:s=>{x.emit(b.showError,s.error_description),console.log("Login Failed:",s)}});return t.jsx(E,{onClick:()=>d(),src:"/assets/dummy/google.png",alt:"",className:"h-7"})}function W({onDone:n}){const e=w(O),d=P(),s=window.location.origin,i=`https://oauth.telegram.org/auth?bot_id=${e}&origin=${s}/auth/login`,u=async c=>{var a,o;try{await R({token:c,provider:"telegram"}),n("telegram"),v.showToast(j.login_successfully())}catch(r){console.log("error:",r),x.emit(b.showError,((o=(a=r.response)==null?void 0:a.data)==null?void 0:o.message)??r.message)}};return l.useEffect(()=>{const c=d.hash,o=new URLSearchParams(c.substring(1)).get("tgAuthResult");if(!(!o||!e))try{o&&u(o)}catch(r){console.error("Error parsing Telegram auth result:",r)}},[d.hash,e]),t.jsx(t.Fragment,{children:t.jsx("a",{href:i,children:t.jsx(E,{src:"/assets/dummy/tele.png",alt:"",className:"h-7"})})})}function Z({title:n}){const{loginType:e}=w(U),d=T(q),s=async i=>{const u=await H();u!=null&&d(u),v.showToast(j.login_successfully()),i!=="telegram"?v.navigateBack():v.navigate("/")};return t.jsx(t.Fragment,{children:Object.values(e??{}).some(i=>i)&&t.jsxs("div",{className:"mt-8",children:[t.jsx("div",{className:"w-full text-center border-b border-b-[#3d3c42] relative",children:t.jsx("span",{className:"bg-[var(--auth-bg)] px-1 text-sm text-[var(--text-content-color)] absolute top-[-10px] left-[50%] translate-x-[-50%]",children:n})}),t.jsxs("div",{className:"flex items-center justify-center gap-8 pt-8 w-full overflow-x-auto hide-scrollbar",children:[e!=null&&e.telegram?t.jsx(W,{onDone:s}):t.jsx(t.Fragment,{}),(e==null?void 0:e.twitter)&&t.jsx(D,{}),(e==null?void 0:e.facebook)&&t.jsx(M,{onDone:s}),(e==null?void 0:e.line)&&t.jsx($,{}),(e==null?void 0:e.google)&&t.jsx(K,{onDone:s})]})]})})}export{Z as SocialAuthList};
