import{A as se,D as ie,u as ce,r as l,E as L,T as r,j as a,N as oe,L as le,F as ne,H as x,R as de,v as pe,C as z,M as ue,I as xe,J as he,K as te,l as fe,G as me}from"./index-BRyeyo8a.js";import{u as ge}from"./controller-dAH6l-TT.js";import{g as ye,m as ve,d as be}from"./deposit-DeSSEGEb.js";function _e(){const{getPayAccountsOff:v,getPayAccountsOn:$}=ge(),[e,R]=se(ie),D=ce(),w=new URLSearchParams(D.search),[s,C]=l.useState([]),[_,b]=l.useState(null),[i,k]=l.useState(!0),d=e.find(h=>{var m;return h.code==((m=w.get("payType"))==null?void 0:m.toString())}),g=async h=>{var m;if(w.get("payType")){k(!h);const N=((m=w.get("payType"))==null?void 0:m.toString())||"",[u,y]=await Promise.all([v(N)||[],$(N)||[]]),A=Array.isArray(u)&&u.length>0?u.map(M=>({...M,paymentMethod:"offline"})):[],O=Array.isArray(y)&&y.length>0?y.map(M=>({...M,paymentMethod:"online"})):[];C([...A,...O])}k(!1)},T=async()=>{const h=L.currentLang(),N=(await ye()).filter(u=>u.languages&&!u.languages.includes(h)||u.bankFlag==0&&u.transferEnabled!=1?!1:u.transferEnabled==1||u.onlinePayEnabled==1);R(N)};l.useEffect(()=>{g(!1),e.length==0&&T();const h=setInterval(()=>{g(!0)},5e3);return()=>clearInterval(h)},[]),l.useEffect(()=>{s.length>0&&b(s[0])},[s]);const j=L.currentLang()=="zh"?((d==null?void 0:d.name)??"")+r.deposit():((d==null?void 0:d.name)??"")+" "+r.deposit();return a.jsx(oe,{title:j,className:"max-w-[800px] mx-auto bg-[var(--page-mob-bg)]",children:i?a.jsx(le,{className:"grow"}):s.length>0&&_&&_.id?a.jsx("div",{className:"overflow-hidden overflow-y-auto hide-scrollbar h-full pb-3",children:a.jsx(je,{payList:s,firstItem:_})}):a.jsxs("div",{className:"flex w-full h-full flex-col justify-stretch items-center px-10 mt-10",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 157.2 155.2",width:160,height:160,className:"text-[var(--text-color)]",children:a.jsxs("g",{children:[a.jsx("path",{fill:"var(--active)",d:`M151.3,28.3c-2.3,0.4-3.9,1.4-4.9,2.7c-1,1.3-1.5,3-1.7,4.7c0,0-0.1,0-0.1,0C130.4,14.2,106,0,78.3,0
			c-38.7,0-71,27.7-78,64.4C0.1,64.7,0.1,65,0,65.3c0,0.2,0,0.4,0,0.5c0,3.1,2.6,5.7,5.9,5.7c2.6,0,4.9-1.7,5.6-4c0,0,0,0,0,0
			c0.1-0.4,0.2-0.9,0.2-1.3c6.2-31.1,33.6-54.6,66.5-54.6c32.8,0,60.1,23.2,66.4,54.1v0c0,0.1,0.1,0.2,0.1,0.3c0,0,0,0,0,0.1
			c0.1,0.5,0.2,1,0.3,1.4c0,0,0,0,0,0c0.8,2.3,3,3.9,5.7,3.9c3.1,0,5.6-2.2,5.9-5.1c0,0,0,0,0,0c0-0.2,0-0.4,0-0.6c0-0.1,0-0.3,0-0.4
			v0l0.5-29.8v0C156.6,27.5,151.3,28.3,151.3,28.3z`}),a.jsx("path",{fill:"var(--active)",d:`M151.3,83.7c-2.6,0-4.9,1.7-5.6,4c0,0,0,0,0,0c-0.1,0.4-0.2,0.9-0.2,1.3c-6.2,31.1-33.6,54.6-66.5,54.6
			c-32.8,0-60.1-23.2-66.4-54.1v0c0-0.1-0.1-0.2-0.1-0.3c0,0,0,0,0-0.1c-0.1-0.5-0.2-1-0.3-1.4c0,0,0,0,0,0c-0.8-2.3-3-3.9-5.7-3.9
			c-3.1,0-5.6,2.2-5.9,5.1c0,0,0,0,0,0.1l0,1L0,119.6v0c0.6,8.1,5.9,7.3,5.9,7.3c2.3-0.4,3.9-1.4,4.9-2.7c1-1.3,1.5-3,1.7-4.7
			c0,0,0.1,0,0.1,0c14.2,21.5,38.6,35.7,66.3,35.7c38.7,0,71-27.7,78-64.4c0.1-0.3,0.1-0.6,0.2-0.9c0-0.2,0-0.4,0-0.5
			C157.2,86.3,154.6,83.7,151.3,83.7z`}),a.jsx("polygon",{fill:"var(--active)",points:"52.8,45.3 42.7,38.2 36.8,44.1 42.3,54.4 47.7,56.3 62.2,70.7 68.1,64.4 54.7,50.6 	"}),a.jsx("path",{fill:"var(--active)",d:"M92.5,86.3l-8.8,9.5l18.8,21.2c2.9,3.3,7.9,3.6,11.2,0.7c3.6-3.1,3.6-8.7,0.1-11.9L92.5,86.3z"}),a.jsx("path",{fill:"var(--active)",d:`M99.7,40.3c1.2-1.2,0.8-3.3-0.8-4c-1.9-0.8-4.7-1.3-7.8,0.3c0,0-11.5,4.2-12.5,23.2L43.4,95.8c-3.9,4-5.5,9.8-3.7,15.1
			c1.2,3.5,3.8,6.6,9.2,6.6c4.3,0.1,8.4-1.8,11.3-4.9l34-34.7c0,0,26.5,1.5,26.1-19.8c0-1.6-1.9-2.6-3.2-1.6l-5.4,3.9
			c-2.8,2-6.2,3-9.6,2.5c-3.1-0.4-6.4-2-8-6.5c-1.6-4.6-0.3-9.8,3.1-13.4L99.7,40.3z M50.7,109.4c-2.1,0-3.8-1.7-3.8-3.8
			c0-2.1,1.7-3.8,3.8-3.8c2.1,0,3.8,1.7,3.8,3.8C54.5,107.6,52.8,109.4,50.7,109.4z`})]})}),a.jsx("div",{className:"mt-3 text-sm text-center",children:r.recharge_method_maintaince()}),a.jsx("div",{className:"mb-10 text-sm text-center",children:r.choose_another_channel()}),a.jsx(ne,{title:r.customer_service_recharge(),onClick:x.clickOnlineService,className:"cursor-pointer"}),a.jsx("div",{className:"mt-3 text-xs text-center text-[#979ca5]",children:r.note_recharge_maintaince_1()}),a.jsx("div",{className:"text-xs text-[#979ca5] text-center",children:r.note_recharge_maintaince_2()})]})})}function je({payList:v,firstItem:$}){var V,F,J,U,q,B,G,H,K,Q,W,X,Y,Z,I;const[e,R]=l.useState($),[D,w]=l.useState(!0),[s,C]=l.useState(""),[_,b]=l.useState(!1),[i,k]=l.useState(null),[d,g]=l.useState(),{userInfo:T}=de(pe);L.currentLang();const j=l.useRef(null);l.useEffect(()=>()=>{C("")},[]),l.useEffect(()=>{var t;try{if(e&&(e!=null&&e.paymentTutorial)&&((t=e==null?void 0:e.paymentTutorial)==null?void 0:t.length)>0){const c=JSON.parse(e.paymentTutorial),p=L.currentLang();let o;c.map(f=>{f.code===p&&!o&&(o=f)}),g(o||null)}else g(null)}catch{g(null)}},[e]),l.useEffect(()=>{x.setRechargeAmount(s)},[s]);const h=t=>{var S;if(Number(s)<=0)return;const c=T==null?void 0:T.fullName,p={payAccountId:e.id,amount:s,rechargePerson:c??"",validateCaptcha:t??""},o={payAccountId:e==null?void 0:e.id,payType:e==null?void 0:e.payType,amount:s,rechargePerson:c??"",validateCaptcha:t??"",tpPayChannelsId:(e==null?void 0:e.merchantId)??null,currency:(S=e.payTypeEntity)==null?void 0:S.currency},f=JSON.stringify(o),E=te(f);if(e.paymentMethod=="online"){const{...P}=p;m({payChannelId:p.payAccountId,...P})}e.paymentMethod=="offline"&&u(p,E)},m=async t=>{var c,p,o,f,E,S,P,ee,ae;try{const n=await ve(t);n&&(n!=null&&n.link)?(k(n),b(!0)):n&&(n!=null&&n.response)&&((p=(c=n==null?void 0:n.response)==null?void 0:c.data)!=null&&p.messsage||(f=(o=n==null?void 0:n.response)==null?void 0:o.data)!=null&&f.msg)?x.showInfoToast(((S=(E=n==null?void 0:n.response)==null?void 0:E.data)==null?void 0:S.messsage)||((ee=(P=n==null?void 0:n.response)==null?void 0:P.data)==null?void 0:ee.msg)):x.showError(r.failed())}catch{x.showError(r.failed())}finally{(ae=j.current)==null||ae.refresh()}},N=()=>{let t={pathname:`/deposit/online-pay/${i==null?void 0:i.orderNo}`};i!=null&&i.link&&(t={...t,search:`?viewType=${e.viewType}&link=${te(i==null?void 0:i.link)}`}),e.paymentMethod=="online"&&i&&(b(!1),i&&i.orderNo&&x.navigate(t,{replace:!0}),(e==null?void 0:e.viewType)==0&&i&&i.link&&(typeof i.link=="string"||i.link instanceof String)&&setTimeout(()=>{window.open(i.link,"_blank")},100))},u=async(t,c)=>{var p;try{const o=await be(t);o!=null&&o.orderNo&&x.navigate(`/deposit/crypto-wallet/${o.orderNo}?info=${c}`)}catch(o){const{response:{data:{message:f}}}=o;x.showInfoToast(f)}finally{(p=j.current)==null||p.refresh()}},y=t=>{isNaN(Number(t))||C(t)},A=t=>{C(""),R(t)},O=async()=>new Promise(t=>{var c;(c=j.current)==null||c.verify(),fe.on(me.waitFor3rdCaptcha,p=>{t(p)})}),M=async()=>{var t;if(!e.rechargeConfig){x.showInfoToast(r.payment_method_closed());return}if(e!=null&&e.limitDepositStatus&&(Number(s)>((e==null?void 0:e.limitDepositMax)??1/0)||Number(s)<((e==null?void 0:e.limitDepositMin)??1))){x.showInfoToast(r.limit_deposit_amount({_min:e==null?void 0:e.limitDepositMin,_max:e==null?void 0:e.limitDepositMax}));return}if(((t=e.rechargeConfig)==null?void 0:t.validateCodeEnabled)==1){const c=await O();if(!c)return;h(c);return}h("")},re=t=>{try{return a.jsx(a.Fragment,{children:t&&a.jsx("div",{dangerouslySetInnerHTML:{__html:t}})})}catch{return null}};return a.jsxs("div",{className:"p-3 bg-[var(--page-mob-bg)]",children:[a.jsx("div",{className:"grid grid-cols-3 gap-2 mt-1 overflow-x-auto hide-scrollbar",children:D&&v.length>6?v.slice(0,6).map((t,c)=>a.jsxs("div",{onClick:()=>A(t),className:`hover:cursor-pointer hover:border-[var(--active)] flex flex-col relative items-center justify-center min-h-[60px] rounded-md py-3 px-3 ${e.id==t.id?"border border-[var(--active)] text-[var(--active)]":"border border-[transparent] bg-[var(--box-bg)]"}`,children:[t.hot&&a.jsx("span",{className:"absolute top-0 left-0 py-0.5 px-1 bg-[#ff0051] flex items-center justify-center rounded-tl-md rounded-br-md",children:a.jsx(z,{src:"/assets/dummy/ic_hot.png",alt:"",className:"h-3 w-3"})}),a.jsx("span",{className:"text-nowrap text-base font-semibold whitespace-nowrap overflow-hidden text-ellipsis w-full",children:t.name}),a.jsx("span",{className:`text-nowrap text-[0.75rem] whitespace-nowrap  ${e.id==t.id?"text-[var(--active)]":"text-[gray]"}`,children:t.limitDepositStatus!==0?`${r.limit()}: ${t.limitDepositMin} - ${t.limitDepositMax}`:a.jsx("span",{className:"text-transparent",children:"-"})})]},t.id)):v.map((t,c)=>a.jsxs("div",{onClick:()=>{A(t)},className:`hover:cursor-pointer hover:border-[var(--active)] flex flex-col relative items-center justify-center min-h-[60px] rounded-md py-3 px-3 ${e.id==t.id?"border border-[var(--active)] text-[var(--active)]":"border border-[transparent] bg-[var(--box-bg)]"}`,children:[t.hot&&a.jsx("span",{className:"absolute top-0 left-0 py-0.5 px-1 bg-[#ff0051] flex items-center justify-center rounded-tl-md rounded-br-md",children:a.jsx(z,{src:"/assets/dummy/ic_hot.png",alt:"",className:"h-3 w-3"})}),a.jsx("span",{className:"text-nowrap text-base font-semibold whitespace-nowrap overflow-hidden text-ellipsis w-full",children:t.name}),a.jsx("span",{className:`text-nowrap text-[0.7rem] whitespace-nowrap  ${e.id==t.id?"text-[var(--active)]":"text-[gray]"}`,children:t.limitDepositStatus!==0?`${r.limit()}: ${t.limitDepositMin} - ${t.limitDepositMax}`:a.jsx("span",{className:"text-transparent",children:"-"})})]},t==null?void 0:t.id))}),D&&v.length>6&&a.jsx("div",{onClick:()=>{w(!1)},className:"hover:cursor-pointer w-full flex justify-center my-4",children:a.jsx("span",{className:"hover:text-[var(--active)] text-sm text-[gray] capitalize",children:`${r.load_more()} >`})}),a.jsxs("div",{className:"text-label mt-5 mb-2 flex justify-between",children:[a.jsx("span",{children:r.deposit_amount()}),!!((V=e==null?void 0:e.rechargeConfig)!=null&&V.rechargeDiscountValue)&&a.jsxs("span",{className:"text-[#ffb400] capitalize",children:[r.bonus()," ",(F=e==null?void 0:e.rechargeConfig)==null?void 0:F.rechargeDiscountValue," ",((J=e==null?void 0:e.rechargeConfig)==null?void 0:J.rechargeDiscountMode)==0?"%":(U=e.payTypeEntity)==null?void 0:U.currency]})]}),a.jsxs("div",{className:"flex items-center input-all input-all__border !text-[var(--active)] text-2xl font-bold h-[42px] input-login-register",children:[a.jsx("div",{className:"min-w-fit px-2 text-center border-r border-r-[var(--navbar-bg)]",children:(q=e.payTypeEntity)==null?void 0:q.currency}),a.jsx("input",{type:"number",inputMode:"numeric",value:s,onChange:t=>y(t.target.value),placeholder:r.enter_select_amount(),className:"grow px-3 py-1 input-all !text-[var(--active)] h-full"}),a.jsx(ue,{onClick:()=>y(""),color:"#333239",name:"ic_round_close",className:"w-4 h-4 mr-2"})]}),(e==null?void 0:e.boardAmountItems)&&a.jsx("div",{className:"py-3 grid grid-cols-4 gap-2",children:(B=e==null?void 0:e.boardAmountItems)==null?void 0:B.split(",").map((t,c)=>a.jsx("div",{onClick:()=>y(t),className:`cursor-pointer rounded-lg text-center p-2 font-semibold ${Number(s)==t?"bg-[var(--active)] text-[black]":"bg-[var(--box-bg)] text-support"}`,children:t},t))}),a.jsx("div",{className:"text-label text-xs h-6",children:s&&a.jsxs(a.Fragment,{children:[r.actual_amount_received(),":",a.jsxs("span",{className:"text-[var(--active)] text-base font-bold pl-2",children:[Number(s),a.jsx("span",{className:"text-xs",children:(G=e.payTypeEntity)==null?void 0:G.currency}),Number(s)==0||!((H=e==null?void 0:e.rechargeConfig)!=null&&H.rechargeDiscountValue)?"":a.jsxs("span",{children:[" ","+"," ",a.jsxs("span",{className:"text-[#ffb400]",children:[((K=e==null?void 0:e.rechargeConfig)==null?void 0:K.rechargeDiscountMode)==0?(Math.floor(Number(s))/100*Number((Q=e==null?void 0:e.rechargeConfig)==null?void 0:Q.rechargeDiscountValue)).toFixed(2):(W=e==null?void 0:e.rechargeConfig)==null?void 0:W.rechargeDiscountValue,a.jsx("span",{className:"text-xs",children:(X=e.payTypeEntity)==null?void 0:X.currency})]})]})]})]})}),a.jsx("div",{className:"mt-4 px-5",children:a.jsx(ne,{disable:Number(s)<=0,title:r.deposit(),onClick:()=>M(),className:"uppercase cursor-pointer"})}),a.jsx("div",{className:"mt-10 text-xs text-[var(--text-content-color)]",children:a.jsx("div",{className:"overflow-hidden overflow-y-auto hide-scrollbar h-full",children:d!=null&&d.value?re(d==null?void 0:d.value):null})}),a.jsx(xe,{open:_,onClose:()=>b(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",className:"flex items-center justify-center",children:a.jsxs("div",{className:"mob:rounded-xl pc:rounded-xl bg-[#2f2f31] text-white w-[300px] p-3 outline-none border-none",children:[a.jsxs("div",{className:"w-full flex justify-center items-end h-10",children:[a.jsx(z,{src:x.getRemoteImgPath((Y=e==null?void 0:e.payTypeEntity)==null?void 0:Y.icon),alt:"",className:"w-auto h-8 mr-1"}),a.jsx("div",{className:"text-lg font-bold pl-1",children:(Z=e==null?void 0:e.payTypeEntity)==null?void 0:Z.name})]}),a.jsx("div",{className:"mt-3 text-base text-center",children:r.question_pay()}),a.jsxs("div",{className:"flex justify-around mt-3",children:[a.jsx("button",{className:"rounded-md p-2 px-10 text-white border border-[var(--active)] text-center cursor-pointer",onClick:()=>{b(!1)},children:r.cancel()}),a.jsx("button",{onClick:()=>N(),className:"rounded-md p-2 px-10  text-black bg-[var(--active)] capitalize font-bold text-center cursor-pointer",rel:"noreferrer",children:r.confirm()})]})]})}),((I=e.rechargeConfig)==null?void 0:I.validateCodeEnabled)==1&&a.jsx(he,{ref:j})]})}export{_e as PixDepositView};
