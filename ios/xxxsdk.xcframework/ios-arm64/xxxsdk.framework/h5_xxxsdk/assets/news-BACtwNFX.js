import{O as H,r as o,A as M,aJ as O,j as e,N as A,T as i,M as N,L as $,h as F,a7 as b,cR as y,aA as J,H as C,f as V}from"./index-BRyeyo8a.js";import{r as G,g as v}from"./news-BN2db2RA.js";const P=H({key:"news",default:{data:[],totalCount:0,page:1,rows:20}});function W(){const[a,n]=o.useState([]),[l,c]=o.useState(!1),[s,d]=M(P),[g,m]=o.useState(!1),[S,x]=o.useState(!1),[z,h]=o.useState(!1),[u,p]=o.useState(!1),{i18n:{language:_}}=O(),k=t=>{if(a.includes(t.id)){n(a.filter(r=>r!=t.id));return}n([...a,t.id])},T=()=>{if(a.length==s.data.length){n([]);return}n(s.data.map(t=>t.id))},I=()=>{a.length!=0&&x(!0)},R=async()=>{try{h(!0),await Promise.all(a.map(t=>G(t))),await w()}catch{}finally{c(!1),n([]),x(!1),h(!1),C.showToast(i.successfully_deleted())}},w=async()=>{s.data.length==0&&m(!0);const t={page:1,rows:20},r=await v(t);d({...t,...r}),m(!1)},D=async t=>{const{scrollTop:r,scrollHeight:L,clientHeight:E}=t.target;if(r+E+200>L&&s.data.length<s.totalCount&&!u){p(!0);const j={page:s.page+1,rows:20};try{const f=await v(j);d({...s,page:j.page,totalCount:f.totalCount,data:[...s.data,...f.data]})}catch(f){console.error("Error fetching news:",f)}finally{p(!1)}}};return o.useEffect(()=>{w()},[_]),e.jsx(A,{title:i.notification(),className:"max-w-[800px] mx-auto ",rightEl:e.jsxs(e.Fragment,{children:[!l&&e.jsx(N,{color:"var(--arrow-color)",name:"ic_delete2",className:" w-4 h-5",onClick:()=>c(!0)})," ",l&&e.jsx("span",{onClick:()=>c(!1),className:"text-sm text-[var(--active)]",children:i.finish()})]}),children:e.jsxs(e.Fragment,{children:[g&&e.jsx($,{className:"grow"}),!g&&s.data.length==0&&e.jsx(F,{className:"grow"}),e.jsxs("div",{className:" overflow-hidden overflow-y-auto hide-scrollbar h-full pb-3",onScroll:D,children:[e.jsxs("div",{className:"flex flex-col gap-2 w-full h-full p-3",children:[s.data.length>0&&s.data.map(t=>e.jsx(q,{showDelete:l,selected:a.includes(t.id),onChange:()=>k(t),item:t},t.id)),u&&e.jsxs("div",{className:"p-4 mb-3 relative rounded-md bg-[var(--box-bg)] h-[92px]",children:[e.jsx("div",{className:"flex justify-between items-center w-full mb-2 text-lg font-bold",children:e.jsx(b,{animation:"wave",width:"100%"})}),e.jsx("div",{className:"flex justify-between items-center w-full",children:e.jsx(b,{animation:"wave",width:"100%"})})]})]}),l&&e.jsxs("div",{className:"fixed bottom-0 w-full flex items-center justify-between bg-[var(--box-bg)] p-3 pb-5",children:[e.jsx(y,{checked:a.length==s.data.length,onChange:()=>T()}),e.jsx("span",{className:"grow px-2 text-[#7e7e81]",children:i.select_all()}),e.jsxs("button",{onClick:I,className:`flex items-center gap-3 rounded-full bg-[var(--separator2)] uppercase px-3 py-2 ${a.length>0?"text-[#ffffff]":"text-[#949496]"}`,children:[e.jsx(N,{color:a.length>0?"text-[#ffffff]":"text-[#6f6f73]",name:"ic_delete2",className:"w-4 h-5"}),i.delete()]})]}),e.jsx(J,{content:i.delete_noti(),onClose:()=>x(!1),onConfirm:R,open:S})]})]})})}function q({showDelete:a,selected:n,item:l,onChange:c}){const s=()=>{const d=JSON.stringify(l);sessionStorage.setItem("notification_detail_data",d),C.navigate(`${V.newsDetail}`)};return e.jsxs("div",{className:"flex items-center gap-3",children:[a&&e.jsx("div",{children:e.jsx(y,{checked:n,onChange:()=>c()})}),e.jsxs("div",{onClick:s,className:"p-3 rounded-md bg-[var(--box-bg)] grow",children:[e.jsx("h2",{className:"text-lg font-semibold text-[#e7e7e7] leading-5",children:l.messageTitle}),e.jsx("p",{className:"text-xs text-[#8b8b8f] py-1 text-support",children:l.messageContent}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsx("span",{className:"text-xs text-[#4b4c51]",children:l.addTime}),e.jsx("span",{className:`w-2 h-2 circle ${l.readStatus==0?"bg-[var(--active)]":"bg-[#58585c]"} `})]})]})]})}export{W as NewsView};
