import{r as d,u as F,R as M,ap as de,T as a,a0 as c,j as e,B as ue,C as O,g as he,M as E,aq as fe,H as m,p as J,F as X,N as me,S as Z,X as we,f as p,ar as xe,v as q,a as pe,t as ge,A as D,as as be,at as _e,l as G,G as Q,au as je,Z as z,L as ve,a5 as Ne,av as ye,aw as We,x as ke,ax as Ce}from"./index-BRyeyo8a.js";import{A as Se,a as Ae,b as Te,c as Ee}from"./add-e-wallet-modal-B04U7uEM.js";import"./ClickAwayListener-2fbp9eZL.js";import"./GlobalStyles-Dtc_kgga.js";function Ie({isOpen:t,onClose:h,onSelected:b,wallets:i,onHandleAdd:u,onUpdateDefaultWallet:s,type:w}){const[r,l]=d.useState(i),[o,_]=d.useState(!1);F();const j=M(de(w));d.useEffect(()=>{o||i.length<=3?l(i):o||l(i.slice(0,3))},[o,i]);const W=g=>{g.defaultBank||fe(g.id).then(S=>{s&&s(g)})};let y=a.add_wallet_address(),k=a.crypto_wallets(),C=a.max_wallet_to_add_hint({_num:j});w==c.BANK&&(y=a.add_bank_card(),k=a.debit_card_bank_card(),C=a.max_bank_to_add_hint({_num:j})),w==c.CRYPTO_WALLET&&(y=a.add_crypto_wallet(),k=a.receiving_wallet()),w==c.E_WALLET&&(k=a.e_wallets());const v=()=>{if(j<=i.length){m.showInfoToast(C);return}u&&u()};return e.jsx(ue,{open:t,onClose:h,title:k,titleClassName:"border-none mob:rounded-t-xl pc:rounded-xl",titleBackgroundColor:"var(--select-wallet-box-bg)",className:"!bg-[var(--select-wallet-bg)] !p-0",children:e.jsxs("ul",{children:[r.map((g,S)=>e.jsxs("li",{onClick:()=>{b(g),h&&h()},className:"flex items-center mx-3 mt-3 p-4 max-w-full bg-[var(--select-wallet-box-bg)] rounded-lg",children:[g.fullIconUrl&&e.jsx(O,{src:g.fullIconUrl,alt:"",className:"w-9 aspect-square"}),e.jsxs("div",{className:"px-3 grow max-w-[70vw]",children:[e.jsx("div",{className:"overflow-hidden text-wrap break-words w-full font-bold",children:g.cardNo}),e.jsxs("div",{className:"text-xs text-[#d9d9da]",children:[g.bankName," (",g.chainName||g.subAddress,")"]})]}),e.jsx("div",{className:"grow"}),e.jsx(he,{checked:g.defaultBank==1,onChange:f=>f&&W(g)})]},S)),!o&&i.length>3&&e.jsx("div",{className:"my-4 flex items-center justify-center w-full text-[#4e4e50] text-sm",children:e.jsx("span",{onClick:()=>_(!0),children:a.show_all()})}),e.jsx("div",{className:"h-3"}),u&&e.jsxs("li",{onClick:v,className:"bg-[var(--select-wallet-box-bg)] flex items-center justify-center gap-3 py-5 text-[#78787b]",children:[e.jsx(E,{color:"#78787b",name:"ic_add",className:"w-3 h-3"}),e.jsx("span",{children:y})]})]})})}function Le(t){return e.jsxs(J,{open:t.isShow,onClose:t.onCancel,showTitle:!1,title:"",className:"max-w-[330px] px-5",children:[e.jsx("div",{className:"text-center text-lg pt-3",children:t.title}),e.jsxs("div",{className:"flex gap-9 px-2 pt-7",children:[e.jsx("a",{className:"rounded-md w-1/2 p-2 border border-[var(--active)] text-center",onClick:t.onCancel,children:a.cancel()}),e.jsx("a",{target:"_blank",onClick:t.onConfirm,className:"rounded-md w-1/2 p-2 text-black bg-[var(--active)] capitalize font-bold text-center",rel:"noreferrer",children:a.confirm()})]})]})}function Be({numberOfDigits:t=6,onChange:h}){const[b,i]=d.useState(new Array(t).fill("")),u=d.useRef([]);function s(r,l){var _,j;const o=[...b];if(r?o[l]=r[r.length-1]:o[l]=r,l<t-1)for(let W=l+1;W<t;W++)o[W]="";i(o),h(o),r&&l<t-1?(_=u.current[l+1])==null||_.focus():r&&l==t-1&&((j=u.current[l])==null||j.blur())}function w(r,l){var o,_;r.key==="Backspace"&&!r.target.value&&l>0&&((o=u.current[l-1])==null||o.focus()),r.key==="Enter"&&r.target.value&&l<t-1&&((_=u.current[l+1])==null||_.focus())}return e.jsx("div",{className:"flex items-center justify-between gap-2 px-3 py-4",children:b.map((r,l)=>e.jsx("input",{type:"password",inputMode:"numeric",autoFocus:l==0,value:r,maxLength:1,onChange:o=>s(o.target.value,l),onKeyUp:o=>w(o,l),ref:o=>u.current[l]=o,className:"border text-center text-lg w-[13%] h-auto text-[var(--text-color)] px-3 py-2 rounded-md block bg-[var(--bg)] focus:border-2 focus:outline-none appearance-none"},l))})}function Pe({isShow:t,onClose:h,onSubmit:b}){const[i,u]=d.useState(""),s=d.useRef(null);d.useEffect(()=>{t||u("")},[t]);const w=r=>{u(r.target.value)};return e.jsx(J,{onClose:h,open:t,title:a.enter_withdrawal_password(),className:"max-w-[90vw] modal-custom-class",children:e.jsxs("div",{className:"p-3 pb-0",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("input",{hidden:!0,className:"absolute",ref:s,type:"number",value:i,onChange:w})}),e.jsx(Be,{numberOfDigits:6,onChange:r=>{u(r.join(""))}}),e.jsx(X,{className:"mt-5",title:a.withdraw(),onClick:()=>b(i),disable:i.length<6})]})})}function He(){const t=F(),h=()=>{const i=new Z(t.search);i.setVal("tab",2),i.del("filter"),m.navigate(p.fundingHistory+i.toSearchQuery())},b=()=>t.pathname==p.bankWithdrawal?a.bank_card_withdrawal():t.pathname==p.web3Withdrawal?a.cryptocurrency_withdrawals():t.pathname==p.eWalletWithdrawal?a.e_wallet_payment():a.crypto_wallet_withdrawal();return e.jsx(me,{title:b(),rightEl:e.jsx("div",{onClick:()=>h(),className:"",children:e.jsx(E,{color:"var(--arrow-color)",name:"ic_find_record",className:"w-5 h-5"})}),className:"max-w-[800px] mx-auto bg-[#1e1e22]",children:e.jsx(Re,{})})}function Re(){var K;const t=F(),h=new Z(t.search),{withdrawFiats:b}=we({}),i=b.filter(n=>n.configType==c.BANK),u=b.filter(n=>n.configType==c.CRYPTO_WALLET);let s=c.WEB3;t.pathname==p.bankWithdrawal&&(s=c.BANK),t.pathname==p.cryptoWithdrawal&&(s=c.CRYPTO_WALLET),t.pathname==p.eWalletWithdrawal&&(s=c.E_WALLET);const w=M(xe(s)),{extInfo:r,userExtMonies:l}=M(q),{defaultWallet:o}=pe(),_=ge(q),[j,W]=d.useState(0),[y,k]=d.useState(""),[C,v]=d.useState(!1),[g,S]=d.useState(!1),[f,I]=d.useState(),[$,L]=d.useState(!1),[Y,B]=d.useState(!0),[ee,R]=d.useState(!1),[A,te]=D(be),[ae,se]=D(_e),H=d.useRef(!0),U=d.useMemo(()=>{let n=s==c.WEB3?h.findString("token",""):"";n||(n=(f==null?void 0:f.currency)||(r==null?void 0:r.currency)||"CNY");const x=(l||[]).find(N=>N.currency==n);return{...x,money:x.currency==(o==null?void 0:o.currency)?o.money:x.money}},[r,f,w,l,t,o]);async function re(){await Promise.all([z.fetchWithdrawalConfig(),Ne(),ye().then(n=>{var x;W(((x=n.data)==null?void 0:x.totalBetAmountToWithDraw)??0)})]),Object.keys(ae).length==0&&We().then(n=>se(n)),B(!1)}const T=()=>{m.accessToken()&&ke().then(n=>{n!=null&&_(n)})},ne=n=>{if(n.length!=6){m.showError(a.invalid_withdrawal_passcode());return}L(!1),B(!0),Ce({cashMoney:parseFloat(y),cashPassword:n,userBankId:(f==null?void 0:f.id)??0,systemBankId:f==null?void 0:f.systemBankId},s==c.WEB3).then(x=>{var N,P,V;if(B(!1),!(x!=null&&x.success)&&((N=x.error)==null?void 0:N.code)=="WITHDRAWAL_HISTORY_IS_FALSE"){const ie=JSON.stringify((P=x.error)==null?void 0:P.message);sessionStorage.setItem("WITHDRAWAL_HISTORY_IS_FALSE_data",ie),m.navigate(`${p.validWithdraw}`);return}if(!x.success){m.showError(((V=x.error)==null?void 0:V.message)??"");return}k(""),m.showToast(a.withdraw_successful()),G.emit(Q.refreshUserInfo)})},le=()=>{!f||!parseFloat(y)||L(!0)},oe=()=>{v(!1),S(!1),I(void 0),L(!1),B(!1),R(!1)},ce=()=>{if(oe(),s==c.WEB3){if(i.length>0){m.navigate(p.bankWithdrawal+t.search,{replace:!0});return}if(u.length>0){m.navigate(p.cryptoWithdrawal+t.search,{replace:!0});return}return}if(s==c.BANK){if(u.length>0){m.navigate(p.cryptoWithdrawal+t.search,{replace:!0});return}m.navigate(p.web3Withdrawal+t.search,{replace:!0});return}if(s==c.CRYPTO_WALLET){m.navigate(p.eWalletWithdrawal+t.search,{replace:!0});return}if(s==c.E_WALLET){m.navigate(p.web3Withdrawal+t.search,{replace:!0});return}};return d.useEffect(()=>{G.emit(Q.refreshUserInfo),re().then(),A.length==0&&je().then(n=>te(n))},[]),d.useEffect(()=>{r&&R(!r.fundPwd)},[r]),d.useEffect(()=>{const n=s==c.WEB3?h.findString("token",""):"";if(n){const N=w.find(P=>P.currency==n);if(N){I(N);return}if(H.current)return}const x=w.find(N=>N.defaultBank)??w[0];w.length>0&&!f&&I(x)},[w]),e.jsxs("div",{className:"bg-[var(--page-mob-bg)] p-3 grow flex flex-col",children:[!Y&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 relative rounded-md bg-[var(--box-bg)] flex items-center gap-2 pb-4",children:[e.jsx(O,{src:m.getCurrencyIcon(U.currency),alt:"",className:"w-10 xs:w-8"}),e.jsxs("div",{className:"text-[#7a7a84] text-xs gap-1 grow",children:[e.jsxs("div",{className:"",children:[e.jsxs("span",{children:[a.account_balance(),":"]}),e.jsx("span",{className:"text-xl text-white font-semibold pl-1 withdrawal-currencyToShow-text",children:U.money}),e.jsx("span",{className:"text-sm ml-0.5",children:U.currency})]}),Number(j)>0&&e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"mr-1",children:[a.need_to_bet()," ",e.jsx("span",{className:"text-sm xs:text-xs text-[#bb9c5f]",children:j}),(K=z.defaultCurrency)==null?void 0:K.currency," ",a.to_withdraw_cash()]}),e.jsxs("div",{className:"text-sm xs:text-xs text-[#bb9c5f] text-nowrap whitespace-nowrap",onClick:()=>m.navigate(p.validWithdraw),children:[a.check()," ",">"]})]})]}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-[var(--page-mob-bg)] absolute top-1 right-1.5",onClick:ce,children:e.jsx(E,{color:"#7a7a84",name:"ic_switch",className:"w-3.5 h-3"})})]}),e.jsx("div",{className:"text-label mt-4",children:a.withdrawal_amount()}),e.jsx("input",{type:"number",value:y,onChange:n=>k(n.target.value),placeholder:a.please_enter_the_withdrawal_amount(),className:"w-full input-all input-all__border px-3 py-1 !text-[var(--active)] text-2xl font-bold rounded-md input-login-register"}),s==c.WEB3&&f&&e.jsxs("div",{className:"pt-2 text-[var(--text-content-color)] text-sm",children:[a.network()," ",f.chainName]}),e.jsx(Ue,{type:s,onClickAdd:()=>v(!0),onClickSelect:()=>S(!0),selectedAccount:f}),e.jsx("div",{className:"px-5",children:e.jsx(X,{onClick:le,title:a.withdraw(),disable:y.trim().length==0||!f,className:"mt-9 uppercase"})}),s==c.BANK&&e.jsx(Se,{open:C,onClose:()=>v(!1),onAdded:T,countries:A}),s==c.WEB3&&e.jsx(Ae,{open:C,onClose:()=>v(!1),onAdded:T,countries:A,preferCurrency:h.findString("token",""),preferChainId:h.findNumber("chainId",-1)}),s==c.CRYPTO_WALLET&&e.jsx(Te,{open:C,onClose:()=>v(!1),onAdded:T,countries:A}),s==c.E_WALLET&&e.jsx(Ee,{open:C,onClose:()=>v(!1),onAdded:T,countries:A}),e.jsx(Ie,{type:s,isOpen:g,wallets:w,onSelected:n=>{H.current=!1,I(n)},onHandleAdd:()=>{S(!1),v(!0)},onUpdateDefaultWallet:n=>T(),onClose:()=>S(!1)}),e.jsx(Le,{isShow:ee,onCancel:()=>{R(!1),m.navigate(-1)},onConfirm:()=>{m.navigate(p.setTransPassword,{state:{isFromWithdrawal:!0}})},title:a.please_set_withdrawal_password_first()}),e.jsx(Pe,{isShow:$,onClose:()=>L(!1),onSubmit:ne})]}),Y&&e.jsx(ve,{className:"grow"})]})}function Ue({type:t,selectedAccount:h,onClickAdd:b,onClickSelect:i}){let u=a.add_wallet_address(),s=a.crypto_wallets();return t==c.BANK&&(u=a.add_bank_card(),s=a.debit_card_bank_card()),t==c.CRYPTO_WALLET&&(u=a.add_crypto_wallet(),s=a.receiving_wallet()),h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between text-label mt-4",children:e.jsx("div",{children:s})}),e.jsx("div",{className:"bg-[var(--box-bg)] rounded-md mt-1 px-3 py-3",children:e.jsx("button",{onClick:i,className:"flex items-center gap-2 w-full border-none bg-transparent rounded-md p-2.5 justify-center",children:e.jsxs("div",{className:"flex items-center w-full gap-3",children:[h.fullIconUrl&&e.jsx(O,{src:h.fullIconUrl,alt:"",className:"w-10 aspect-square"}),e.jsx("span",{className:"grow overflow-hidden text-wrap break-words w-full text-left",children:h.cardNo}),e.jsx("span",{className:"w-6 h-6 min-w-6 circle flex-center bg-[var(--select-wallet-arrow-bg)]",children:e.jsx(E,{color:"var(--text-content-color)",name:"ic_chevon_right",className:"w-3.5 h-3.5"})})]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between text-label mt-4",children:e.jsx("div",{children:s})}),e.jsx("div",{className:"bg-[var(--box-bg)] rounded-md mt-1 p-3",children:e.jsxs("button",{onClick:b,className:"flex items-center gap-2 w-full border bg-[var(--input-bg)] border-[#434348] rounded-md p-2.5 justify-center input-login-register text-support !border-dashed",children:[e.jsx(E,{color:"var(--text-color)",name:"ic_add",className:"w-3 h-3"}),e.jsx("span",{children:u})]})})]})}export{Re as BankWithdrawalContent,He as BankWithdrawalView};
